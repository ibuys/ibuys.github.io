<!DOCTYPE html>
<html lang="en-US">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="stylesheet" href="style.css">
    <link rel="canonical" href="https://jonathanbuys.com/">
    <link rel="icon" type="image/png" href="icon.png">
    <meta property="og:site_name" content="jb">
    <meta property="og:url" content="https://jonathanbuys.com/">
    <meta property="og:title" content="Serverless Jekyll Hosting on AWS - jb">
    <meta property="og:description" content="Some day I won't be able to do this. Today is not that day.">    
	<title>Serverless Jekyll Hosting on AWS - jb</title>
</head>

<body>
  <div class="layout">
	<header>
		<a href="/">JB…</a>
		<p><a href="/archive.html">Archive</a></p>
	</header>

	<main>



		<article>
		<h1>Serverless Jekyll Hosting on AWS</h1>
		    <p>This is a bit silly, I’ll be the first to admit. The contraption I’ve built to host this site is clearly unnecessary, especially when I could host the site on <a href="https://pages.github.com">Github</a> for free, with very little effort, but I was curious, so down the rabbit hole I went. </p>
<p>I thought it would be interesting to <a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/WebsiteHosting.html">host my site on S3</a>. The site is entirely static,  no database back end or dynamic programming required to generate the site, it’s just HTML, CSS, and Javascript. I also wanted to understand the <a href="https://aws.amazon.com/codebuild/">AWS CodeBuild</a> service, and how I might be able to use it for other projects. </p>
<p>There are four components of this system: Github, which hosts the code for the state. The domain name is registered and managed through <a href="https://aws.amazon.com/route53/">Route53</a>, where I’ve configured an “A” record as an alias to point at the S3 bucket which hosts the site. Finally, CodeBuild is the glue which pulls the code from Github, runs <code>jekyll build</code>, and pushes the site to S3. </p>
<p>CodeBuild works by starting a Docker container and pulling the repository down. It then looks for a file named <code>buildspec.yml</code> which contains the instructions to build the project. This file contains arbitrary Linux commands, whatever you need to build your code. Mine looks something like this:</p>
<p>{% highlight yaml %}
version: 0.2</p>
<p>env:
  variables:
SITEBUILD: "yes"
phases:
  install:
commands:
apt-get update -y
  pre_build:
commands:
gem install bundler
    bundle install
  build:
commands:
echo Build started on date
    bundle exec jekyll build
    aws s3 sync _site/ s3://jonathanbuys.com
  post_build:
commands:
echo Build completed on date
{% endhighlight %}</p>
<p>The interesting thing about this system is that I could replace Jekyll with <a href="https://gohugo.io">Hugo</a>, <a href="https://jaspervdj.be/hakyll/">Hakyll</a>, or any other static site generator, even my own scripts, and the system would stay the same. I’d just need to update <code>buildspec.yml</code> with the new commands to install the right tools and build the site. Hosting costs so far have been pennies, my cost this month <em>might</em> reach $1.27, and for the past couple months the cost has been below one dollar. </p>
<p>I’ve been considering making this system more user friendly and monetizing it somehow. There’s a business model to be had in here somewhere, if I care to pursue it. Even though blogging in general appears to be in somewhat of a decline, publishing platforms will always be needed. </p>
		</article>

	</main>
  </div>
	<footer>
		<p><a href="/" class="menu">Home</a> <a href='/about'>About</a></p>		
	</footer>
</body>
</html>


