<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>jb… | Creative Uses for Wordpress</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="Creative Uses for Wordpress">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://localhost:4000/creative-uses-for-wordpress/">
  <meta property="og:description" content="">
  <meta property="og:site_name" content="jb…">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="http://localhost:4000/creative-uses-for-wordpress/">
  <meta name="twitter:title" content="Creative Uses for Wordpress">
  <meta name="twitter:description" content="">

  
    <meta property="og:image" content="http://localhost:4000/assets/og-image-ee46bbc61b334e821e81534b1fd43f3fee6f020ec174b3c2114445695fd48c01.jpg">
    <meta name="twitter:image" content="http://localhost:4000/assets/og-image-ee46bbc61b334e821e81534b1fd43f3fee6f020ec174b3c2114445695fd48c01.jpg">
  

  <link href="http://localhost:4000/atom.xml" type="application/rss+xml" rel="alternate" title="jb… Last 10 blog posts" />

  

  

    
      <link rel="icon" type="image/x-icon" href="/assets/favicon-light-212606391baaa7b16463b92b3c519b56832ab53456441e045807984cad648a1e.ico">
      <link rel="apple-touch-icon" href="/assets/apple-touch-icon-light-87d1f2a3a19b1500e5c1626a0492025ca5f7f97d24540dc5900288e92112925a.png">
      <link rel="stylesheet" type="text/css" title="light" id="light" href="/assets/light-7f522908aad16b87e703f470834aceb4a7ff176aa3d0ea38bc79efa11ac38c6d.css">
      <link rel="stylesheet" type="text/css" title="dark" id="dark" href="/assets/dark-02e2f267b21f6c4c71f528ac48c0e6b6680d4c968ac2a5fa52e4f416874e52a4.css" disabled="true">
    

  
  
</head>

<body>
  <main>
    <div class="grid grid-centered">
      <div class="grid-cell">
        <nav class="header-nav ">
  <a href="/" class="header-logo" title="jb…">jb…</a>
  <ul class="header-links">
    
      <li>
        <a href="/about" title="About me">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-about">
  <use href="/assets/about-ecf154b571ab8034ae00aeed91a3b7ad68db80b46d958753ad6216c919486e88.svg#icon-about" xlink:href="/assets/about-ecf154b571ab8034ae00aeed91a3b7ad68db80b46d958753ad6216c919486e88.svg#icon-about"></use>
</svg>

        </a>
      </li>
    
    
      <li>
        <a href="/microblog/" title="Chirp, chirp">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-twitter">
  <use href="/assets/twitter-8842c33965263ad1b03a978406826677a668f94125d5837e70ab83f24b3213a7.svg#icon-twitter" xlink:href="/assets/twitter-8842c33965263ad1b03a978406826677a668f94125d5837e70ab83f24b3213a7.svg#icon-twitter"></use>
</svg>

        </a>
      </li>
    
    
    
    
      <li>
        <a href="https://github.com/ibuys" rel="noreferrer noopener" target="_blank" title="GitHub">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-github">
  <use href="/assets/github-094f81040819f34343ee6ffff0980f17e2807b08b595eaaf66ae3554934fd78d.svg#icon-github" xlink:href="/assets/github-094f81040819f34343ee6ffff0980f17e2807b08b595eaaf66ae3554934fd78d.svg#icon-github"></use>
</svg>

        </a>
      </li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
      <li>
        <a href="/atom.xml" rel="noreferrer noopener" target="_blank" title="RSS">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-rss">
  <use href="/assets/rss-541ec5cea9cefd10d2fcfec01888f3f231a8829940249835fa7b7b3a12ae0d0d.svg#icon-rss" xlink:href="/assets/rss-541ec5cea9cefd10d2fcfec01888f3f231a8829940249835fa7b7b3a12ae0d0d.svg#icon-rss"></use>
</svg>

        </a>
      </li>
    
    
      <li>
        <a onclick="toggle()" title="Toggle Theme">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-theme">
  <use href="/assets/theme-66869e0bf8dab34bae1c86bda400327b772e0be69e8dc28d3ede896e771320ed.svg#icon-theme" xlink:href="/assets/theme-66869e0bf8dab34bae1c86bda400327b772e0be69e8dc28d3ede896e771320ed.svg#icon-theme"></use>
</svg>

        </a>
      </li>
    
  </ul>
</nav>

        <article class="article ">
          <header class="article-header">
            <h1>Creative Uses for Wordpress</h1>
            <p></p>
            <div class="article-list-footer">
              <span class="article-list-date">
                May 7, 2008
              </span>
              <span class="article-list-divider">-</span>
              <span class="article-list-minutes">
                
                
                  4 minute read
                
              </span>
              <span class="article-list-divider">-</span>
              <div class="article-list-tags">
                
                  <a href="/tag/work">work</a>
                
                  <a href="/tag/linux">linux</a>
                
                  <a href="/tag/shell">shell</a>
                
              </div>
            </div>
          </header>

          <div class="article-content">
            <p>Where I spend my days ($WORK), we have multiple monitoring systems for just about every service on every server that we have.  Many of these are <a href="http://www.nagios.org/">Nagios</a>, some are built in, and others are <a href="https://h10078.www1.hp.com/cda/hpms/display/main/hpms_content.jsp?zn=bto&amp;cp=1-11-15-25%5E849_4000_100__">SiteScope</a>.  All of the systems generate email alerts that either go to our pagers, our email, or both.  From time to time, management would ask a question like “How many pages do you get in a week on average”, which up till a couple of months ago, our answer was always “It just depends”.</p>

<p>Not a great answer, so I decided to start tracking the email alerts with a centralized database.  Now, at this point, I could have whipped up my own home-brew frankenstein creation, but since everything I wanted was already built into Wordpress, I really didn’t need to.  Wordpress has the option of posting blogs via email.  So, all I needed to do was set up a special email account on our mail server and make sure the pop3 server was running.  Then, add the server and login information into Wordpress, setup a cron job to trigger the mail check every five minutes, and there.  Instant logging of all pages that are sent out in a searchable, easy to read, web format.  Now, when management gets it in their mind to start asking questions, we can easily say “Let me reference my report.” They really like hearing things like that.</p>

<p>Building on the success of the alert log, I thought it might be good to also log all of our changes to the system.  This idea is completely different from traditional “Change Management” systems which require you to log ahead of time what you want to accomplish in some ridiculous form or application.  Instead, I find it much more useful and relevant to build in the change logging where we spend most of our time, the command line.</p>

<p>I’ve added an alias for “exit” in the shell like so:
    alias exit=”exec /scripts/ch_log”
Here is the ch_log script:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>
<span class="c"># ch_log - Prompt the user to log system changes on</span>
<span class="c"># exit from the root shell.</span>
<span class="c">#</span>
<span class="c"># jonbuys@os-zen.com - Wed Apr  2 15:32:43 CDT 2008</span>
<span class="c">#</span>
<span class="c">############################################################</span>

<span class="nv">HOST</span><span class="o">=</span><span class="sb">`</span><span class="nb">hostname</span><span class="sb">`</span>
<span class="nv">DATE</span><span class="o">=</span><span class="sb">`</span><span class="nb">date</span> +%m-%d-%y<span class="sb">`</span>
<span class="nb">echo</span> <span class="nv">$DATE</span>
<span class="nb">echo</span> <span class="s2">"Did you make any changes to the system? (y/n)"</span>
<span class="nb">read </span>answer

<span class="k">if</span> <span class="o">[</span> <span class="nv">$answer</span> <span class="o">==</span> n <span class="o">]</span> <span class="p">;</span> <span class="k">then
   </span><span class="nb">echo</span> <span class="s2">"OK, Thanks!"</span>
   <span class="nb">exit </span>0
<span class="k">else
   </span><span class="nb">echo</span> <span class="s2">"Cool, please enter your name, and then describe the changes in the form."</span>
   <span class="nb">echo</span> <span class="s2">"Name:"</span>
   <span class="nb">read </span>NAME

    <span class="nb">cat</span> /scripts/log_template | <span class="nb">sed </span>s/NNN/<span class="nv">$NAME</span>/g | <span class="nb">sed </span>s/DDD/<span class="nv">$DATE</span>/g | <span class="nb">sed </span>s/SSS/<span class="nv">$HOST</span>/g <span class="o">&gt;</span> /tmp/<span class="nv">$$</span>.answer
    vi /tmp/<span class="nv">$$</span>.answer
    mail change_log@mail.mydomain.com <span class="nt">-s</span> <span class="s2">"Change Notification for </span><span class="nv">$HOST</span><span class="s2">"</span>&amp;lt<span class="p">;</span> /tmp/<span class="nv">$$</span>.answer
    <span class="nb">echo</span> <span class="s2">"OK, thanks!"</span>
<span class="k">fi
</span><span class="nb">exit </span>0

<span class="c">############################################################</span>
<span class="c"># EOF: ch_log</span>
</code></pre></div></div>

<p>Basically, when we exit our shell we now have to make a choice… do we log what we did with this quick and easy script, or do we ignore it and risk the consequences.  I’ve found that for the most part, I choose to log my work.  The email that is sent off to the change_log@mail.mydomain.com address is picked up by a second Wordpress install, and posted to the blog.  Now we have a historical record of what we’ve done incase something breaks, or (more importantly) when annual review time comes around and we are asked “what have you been up to”</p>

<p>There is one other change that I had to make to get this to work right.  By default, Wordpress holds all posts it recieves via email for approval before posting it to the main page.  This is good security, but not really needed on an internal LAN, and it breaks the system I’ve laid out above.  So, to fix it, I’ve made a slight change to the wp-mail.php file:
     // Set $post_status based on $author_found and on author’s publish_posts capability
     if ($author_found) {
             $user = new WP_User($post_author);
             if ($user-&gt;has_cap(‘publish_posts’))
                     $post_status = ‘publish’;
             else
                     $post_status = ‘publish’;
     } else {
             // Author not found in DB, set status to pending.  Author already set to admin.
             $post_status = ‘publish’;
     }</p>

<p>Above, I’ve changed the “pending” post_status to “publish” for unidentified users, which is everything that it receives via email.  This is a very bad idea to do outside of the LAN, but I don’t see any harm in it internally.  Undoubtedly there are those who would disagree, but this works well for us.</p>

<p>This is how we are using Wordpress internally on our corporate LAN right now, I’d be interested to hear how some others are using Wordpress or other blogging software.</p>

          </div>
          <div class="article-share">
            
            
            <a href="https://twitter.com/home?status=Creative+Uses+for+Wordpress%20-%20http://localhost:4000/creative-uses-for-wordpress/%20by%20@ibuys" title="Share on Twitter" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M492 109.5c-17.4 7.7-36 12.9-55.6 15.3 20-12 35.4-31 42.6-53.6 -18.7 11.1-39.4 19.2-61.5 23.5C399.8 75.8 374.6 64 346.8 64c-53.5 0-96.8 43.4-96.8 96.9 0 7.6 0.8 15 2.5 22.1 -80.5-4-151.9-42.6-199.6-101.3 -8.3 14.3-13.1 31-13.1 48.7 0 33.6 17.2 63.3 43.2 80.7C67 210.7 52 206.3 39 199c0 0.4 0 0.8 0 1.2 0 47 33.4 86.1 77.7 95 -8.1 2.2-16.7 3.4-25.5 3.4 -6.2 0-12.3-0.6-18.2-1.8 12.3 38.5 48.1 66.5 90.5 67.3 -33.1 26-74.9 41.5-120.3 41.5 -7.8 0-15.5-0.5-23.1-1.4C62.8 432 113.7 448 168.3 448 346.6 448 444 300.3 444 172.2c0-4.2-0.1-8.4-0.3-12.5C462.6 146 479 129 492 109.5z"/></svg>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/creative-uses-for-wordpress/" title="Share on Facebook" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M288 192v-38.1c0-17.2 3.8-25.9 30.5-25.9H352V64h-55.9c-68.5 0-91.1 31.4-91.1 85.3V192h-45v64h45v192h83V256h56.4l7.6-64H288z"/></svg>
            </a>
            <a href="https://plus.google.com/share?url=http://localhost:4000/creative-uses-for-wordpress/" title="Share on Google+" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 128 128"><path d="M40.7 55.9v16.1c0 0 15.6 0 22 0C59.2 82.5 53.8 88.2 40.7 88.2c-13.3 0-23.7-10.8-23.7-24.2s10.4-24.2 23.7-24.2c7.1 0 11.6 2.5 15.8 5.9 3.3-3.3 3.1-3.8 11.6-11.9 -7.2-6.6-16.8-10.6-27.4-10.6C18.2 23.3 0 41.5 0 64c0 22.5 18.2 40.7 40.7 40.7 33.6 0 41.8-29.3 39-48.8H40.7zM113.9 56.7V42.6h-10.1v14.1H89.4v10.1h14.5v14.5h10.1V66.8H128V56.7H113.9z"/></svg>
            </a>
          </div>

          
        </article>
        <footer class="footer ">
  <p>
Copyright © 2007-2019 Jonathan Buys
  </p>
  <p>
  ISSN: 2161-8119
  </p>
</footer>

      </div>
    </div>
  </main>
  <script src="/assets/vendor-0fb4b91f7ad6c193a69224eba7a01b691a2d7528ee672607575ccc0df3aea545.js" type="text/javascript"></script>


  <script src="/assets/webfonts-96493456d319d1bf419afdf8701552d4d486fee6afd304897d4fd81eb4e0cc0b.js" type="text/javascript"></script>




<script src="/assets/application-cfde13ac81ddaf4351b2e739603e2baf688d0fcc9aba613fe62bbb1c7b037fb9.js" type="text/javascript"></script>


  <script src="/assets/themetoggle-df0d3d73164dc26dffbd630182ae4d0dfa7bee6b694a2b5d565d73595b582bbf.js" type="text/javascript"></script>

</body>
</html>
